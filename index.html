<html>
<head>
<title>MIA IPTV AIS</title>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no">
<link rel="stylesheet" type="text/css" href="/clap.css">
<script src="//cdn.jsdelivr.net/npm/@clappr/player@0.4.0/dist/clappr.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/mux.js@5.6.7/dist/mux.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/level-selector@latest/dist/level-selector.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/clappr-chromecast-plugin@latest/dist/clappr-chromecast-plugin.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/clappr-pip@latest/dist/clappr-pip.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/clappr-playback-rate-plugin@latest/dist/clappr-playback-rate-plugin.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/shaka-player@2.5.10/dist/shaka-player.compiled.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/clappr/dash-shaka-playback@latest/dist/dash-shaka-playback.external.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/cdnbye-shaka@latest"></script>
<style> 
body { background-color: #000000; margin:0; }
#menu { padding: 10px; background:#111; color:#fff; text-align:center; }
select { padding: 5px; font-size: 16px; }
</style>
</head>
<body>

<div id="menu">
  <label style="color:#fff;">เลือกช่อง: </label>
  <select id="channelSelect">
    <option value="33">ช่อง 33 HD</option>
    <option value="27">CH8</option>
    <option value="23">Workpoint</option>
  </select>
</div>

<div id="player"></div>

<script>
  // รายชื่อช่อง
  var channels = {
    "33": {
      source: "https://cco-streamer1.cdn.3bbtv.com:8443/3bb/live/33/33.mpd",
      keyId: "9d76aea451d441a4913d4d70c4e586ab",
      key: "051027a6ff54494b949ba792928e9008"
    },
    "27": {
      source: "https://udn-streamer1.cdn.3bbtv.com:8443/3bb/live/27/27.mpd",
      keyId: "4a0a9dd380b4409c8dad910691283a0d",
      key: "1447c104caa244d9a367549534e0b807"
    },
    "23": {
      source: "https://udn-streamer1.cdn.3bbtv.com:8443/3bb/live/23/23.mpd",
      keyId: "8e66726c1191403588f95c0757613ff1",
      key: "67c26ba7f9b84024944808e01bbe6f47"
    }
  };

  var player;

  function loadChannel(id) {
    if (player) {
      player.destroy(); // เคลียร์ player เดิมก่อน
    }
    var ch = channels[id];
    player = new Clappr.Player({
      source: ch.source,
      mimeType: 'application/dash+xml',
      height: '100%',
      width: '100%',
      autoPlay: true,
      plugins: [LevelSelector, DashShakaPlayback, Clappr.MediaControl],
      events: { onReady: function() {
          var plugin = this.getPlugin('click_to_pause');
          plugin && plugin.disable();
      }},
      chromecast: {
          preload: 'metadata',
          contentType: 'video/mpd',
      },
      shakaConfiguration: {
        drm: { clearKeys: { [ch.keyId]: ch.key } }
      },
      parentId: "#player"
    });
  }

  // โหลดค่าเริ่มต้น
  loadChannel("33");

  // เวลาเลือกช่องใหม่
  document.getElementById("channelSelect").addEventListener("change", function() {
    loadChannel(this.value);
  });

</script>

<span style='position:absolute;bottom:10px;right:20px;font-size: 15px; font-weight: bold;color: #ff0;'><em>MIA IPTV</em></span>

</body>
</html>
